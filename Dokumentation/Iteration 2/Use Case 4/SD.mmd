sequenceDiagram
actor Driftsmedarbejder
participant UI      as "BusListView"
participant VM      as "BusListViewModel"
participant Sim     as "SimulationService"
participant FileH   as "FileHelper"
participant Bus     as "Bus obj."

%% ----- Kritisk oversigt -----
Driftsmedarbejder ->> UI: Klik “Kritiske busser”
UI ->> VM: ShowCriticalCmd()
VM ->> Sim: Buses
Sim -->> VM: ObservableCollection<Bus>
VM ->> VM: filter IsCritical
VM -->> UI: liste
UI ->> Driftsmedarbejder: Vis liste

%% ----- Marker til opladning -----
Driftsmedarbejder ->> UI: Vælg bus + “Oplader”
UI ->> VM: MarkChargingCmd(bus)
VM ->> Bus: Status = Oplader
VM ->> FileH: SaveBusesAsync(Sim.Buses)
FileH -->> VM: OK
VM -->> UI: Refresh

%% ----- Marker klar igen -----
Driftsmedarbejder ->> UI: “Klar”
UI ->> VM: MarkReadyCmd(bus)
VM ->> Bus: Status = Garage
VM ->> FileH: SaveBusesAsync(...)
FileH -->> VM: OK
VM -->> UI: Refresh

%% ----- Foreslå opladning -----
Driftsmedarbejder ->> UI: “Foreslå” på bus
UI ->> VM: SuggestCharge(bus)
VM ->> Bus: EstimateChargeTime(rateKW)
Bus -->> VM: TimeSpan
VM -->> UI: tid
UI ->> Driftsmedarbejder: Vis forslag

%% ----- System-notifikation (<20 %) -----
Sim ->> VM: CriticalAlert(bus)
VM ->> UI: Pop-up / rød markering
UI ->> Driftsmedarbejder: Alarm
